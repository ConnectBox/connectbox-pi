# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|

  config.vm.synced_folder '.', '/vagrant', disabled: true


  # Overridden
  config.vm.box = ""

  config.vm.provider "vmware_fusion" do |vmw|
    vmw.memory = "512"
  end
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "512"
  end

  # Debian Stretch
  config.vm.define "stretch" do |stretch|
    stretch.vm.box = "generic/debian9"
    stretch.vm.network "private_network", ip: "172.28.128.5"	
<<<<<<< HEAD
    stretch.vm.post_up_message = "connectbox (Debian Stretch) provisioned in developer mode. IP: 172.28.128.5, hostname: stretch-vagrant.connectbox. You probably want '172.28.128.5 stretch-vagrant.connectbox resettest-stretch-vagrant.connectbox' in /etc/hosts"
=======
    stretch.vm.post_up_message = "ConnectBox (Debian Stretch) provisioned in developer mode. IP: 172.28.128.5, hostname: stretch-vagrant.connectbox. You probably want '172.28.128.5 stretch-vagrant.connectbox resettest-stretch-vagrant.connectbox' in /etc/hosts"
>>>>>>> bb354580ce2e5b02258e4dcf5cb6a845d755a1ff

    stretch.vm.provision "ansible" do |ansible|
      ansible.playbook = "ansible/site.yml"
      ansible.host_vars = {
        "stretch" => {
<<<<<<< HEAD
          "connetbox_default_hostname": "stretch-vagrant.connectbox",
=======
          "connectbox_default_hostname": "stretch-vagrant.connectbox",
>>>>>>> bb354580ce2e5b02258e4dcf5cb6a845d755a1ff
          "developer_mode": true,
          "lan_dns_if": "eth1",
        }
      }
      ansible.skip_tags = "full-build-only"
    end
  end

  # Ubuntu Xenial
  config.vm.define "ubuntu" do |ubuntu|
    # Not using ubuntu/xenial64 because of
    #  https://bugs.launchpad.net/cloud-images/+bug/1569237
    ubuntu.vm.box = "ubuntu/xenial64"
    ubuntu.vm.network "private_network", ip: "172.28.128.4"
<<<<<<< HEAD
    ubuntu.vm.post_up_message = "connectbox (Ubuntu Xenial) provisioned in developer mode. IP: 172.28.128.4, hostname: ubuntu-vagrant.connectbox. You probably want '172.28.128.4 ubuntu-vagrant.connectbox resettest-ubuntu-vagrant.connectbox' in /etc/hosts"
=======
    ubuntu.vm.post_up_message = "ConnectBox (Ubuntu Xenial) provisioned in developer mode. IP: 172.28.128.4, hostname: ubuntu-vagrant.connectbox. You probably want '172.28.128.4 ubuntu-vagrant.connectbox resettest-ubuntu-vagrant.connectbox' in /etc/hosts"
>>>>>>> bb354580ce2e5b02258e4dcf5cb6a845d755a1ff

    ubuntu.vm.provision "ansible" do |ansible|
      ansible.playbook = "ansible/site.yml"
      ansible.host_vars = {
        "ubuntu" => {
<<<<<<< HEAD
          "connectbox_default_hostname": "ubuntu-vagrant.connectbox",
=======
          "connectbox_default_hostname": "ubuntu-vagrant.connectbox",
>>>>>>> bb354580ce2e5b02258e4dcf5cb6a845d755a1ff
          "developer_mode": true,
          "lan_dns_if": "eth1",
        }
      }
      ansible.skip_tags = "full-build-only"
    end
  end
end
